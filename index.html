<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Redirecting …</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="noindex">
  <link rel="canonical" href="/de/index.html">
  <link rel="alternate" hreflang="de" href="/de/index.html">
  <link rel="alternate" hreflang="en" href="/en/index.html">
  <link rel="alternate" hreflang="x-default" href="/index.html">
  <noscript>
    <meta http-equiv="refresh" content="0;url=/de/index.html">
  </noscript>
  <script>
    (function() {
      'use strict';

      function normalise(code) {
        if (!code) return '';
        return String(code).toLowerCase();
      }

      function preferredLanguages() {
        var seen = {};
        var result = [];
        var list = [];
        if (Array.isArray(navigator.languages)) {
          list = list.concat(navigator.languages);
        }
        list.push(navigator.language || navigator.userLanguage || '');
        for (var i = 0; i < list.length; i += 1) {
          var value = normalise(list[i]);
          if (!value || seen[value]) continue;
          seen[value] = true;
          result.push(value);
        }
        return result;
      }

      function queryLanguage() {
        var match = window.location.search.match(/(?:\?|&)lang=([a-zA-Z-]+)/);
        if (match && match[1]) {
          var value = normalise(match[1]);
          if (value.indexOf('de') === 0) return 'de';
          if (value.indexOf('en') === 0) return 'en';
        }
        return '';
      }

      function targetFor(languages) {
        for (var i = 0; i < languages.length; i += 1) {
          if (languages[i].indexOf('en') === 0) {
            return '/en/index.html';
          }
          if (languages[i].indexOf('de') === 0) {
            return '/de/index.html';
          }
        }
        return '/de/index.html';
      }

      function toAbsolute(url) {
        try {
          return new URL(url, window.location.href).toString();
        } catch (error) {
          var anchor = document.createElement('a');
          anchor.href = url;
          return anchor.href;
        }
      }

      var languages = preferredLanguages();
      var override = queryLanguage();
      var target = override === 'en' ? '/en/index.html' : override === 'de' ? '/de/index.html' : targetFor(languages);
      var canonical = document.querySelector('link[rel="canonical"]');
      if (canonical) {
        canonical.setAttribute('href', toAbsolute(target));
      }

      var alternates = document.querySelectorAll('link[rel="alternate"][hreflang]');
      for (var i = 0; i < alternates.length; i += 1) {
        var href = alternates[i].getAttribute('href');
        if (href) {
          alternates[i].setAttribute('href', toAbsolute(href));
        }
      }

      if (window.location.pathname !== target) {
        window.location.replace(target);
      }
    })();
  </script>
</head>
<body>
  <p>Redirecting to the appropriate language version …</p>
  <p>
    <a href="/de/index.html">Zur deutschen Seite</a> ·
    <a href="/en/index.html">Go to the English site</a>
  </p>
  <p>JavaScript is required for automatic language detection. Please choose your language above.</p>
</body>
</html>
